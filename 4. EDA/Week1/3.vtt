WEBVTT

1
00:00:02.550 --> 00:00:06.080
这节课将谈论如何构建探索性图表

2
00:00:06.080 --> 00:00:08.510
探索性图表或多或少是为了你自己的需要而制作的

3
00:00:08.510 --> 00:00:11.220
这样你就可以查看数据并且探索在数据集中发生了什么

4
00:00:11.220 --> 00:00:15.180
这样你就可以查看数据并且探索在数据集中发生了什么

5
00:00:15.180 --> 00:00:17.410
在这里我们要问一个基本问题

6
00:00:17.410 --> 00:00:19.800
为什么我们要在数据分析中使用图表？

7
00:00:19.800 --> 00:00:22.940
这里列出了我们想要达到的各项目的

8
00:00:22.940 --> 00:00:25.170
理解数据的性质

9
00:00:25.170 --> 00:00:27.680
从数据的基本模式中寻找合适的模式

10
00:00:27.680 --> 00:00:30.060
也可能仅仅是提出一些建模策略

11
00:00:30.060 --> 00:00:34.100
比如我们要使用线性还是非线性模型 还有为了找出分析中的错误

12
00:00:34.100 --> 00:00:35.730
也许你已经开始做一个分析

13
00:00:35.730 --> 00:00:38.010
然后想知道哪里出错了

14
00:00:38.010 --> 00:00:39.556
还有我们也想要传达结果

15
00:00:39.556 --> 00:00:43.390
我们想以图表的形式向别人展示一些信息

16
00:00:43.390 --> 00:00:47.430
探索性图表确确实实跟这里列出的前四件事有关

17
00:00:47.430 --> 00:00:50.290
我们想要基本理解数据的性质

18
00:00:50.290 --> 00:00:52.770
我们想要查看一些基本的模式

19
00:00:52.770 --> 00:00:55.400
提出一些建模策略并且找出分析中的错误

20
00:00:55.400 --> 00:00:57.460
但在本节课中

21
00:00:57.460 --> 00:00:59.700
我们将不会谈论如何以传达结果为目的来构建图表

22
00:00:59.700 --> 00:01:01.310
我们将不会谈论如何以传达结果为目的来构建图表

23
00:01:01.310 --> 00:01:03.420
我们会在随后的课程中进行这方面的探讨

24
00:01:04.530 --> 00:01:07.260
探索性图表的一些特点是

25
00:01:07.260 --> 00:01:08.880
它们制作起来非常快

26
00:01:08.880 --> 00:01:12.360
随着你浏览数据 它们也飞快地作好了

27
00:01:12.360 --> 00:01:14.920
你常常需要制作大量的探索性图表

28
00:01:14.920 --> 00:01:18.660
 因为你想要从各个方面了解数据 观察多个变量

29
00:01:18.660 --> 00:01:20.447
并且你通常需要逐个进行浏览

30
00:01:21.670 --> 00:01:23.540
另外它的目标是增加你作为一个分析者 对数据集的个人理解

31
00:01:23.540 --> 00:01:27.400
另外它的目标是增加你作为一个分析者 对数据集的个人理解

32
00:01:27.400 --> 00:01:30.840
并且对数据的整体有所了解

33
00:01:30.840 --> 00:01:32.620
了解其带有哪些属性 存在什么问题

34
00:01:33.710 --> 00:01:35.950
以及接下来还要做什么？

35
00:01:35.950 --> 00:01:40.150
就是让你对数据有一个感觉

36
00:01:40.150 --> 00:01:41.240
如果你想一想

37
00:01:41.240 --> 00:01:43.900
探索性数据分析有什么必须回答的基本问题

38
00:01:43.900 --> 00:01:48.080
那就是数据看起来是什么样的？

39
00:01:48.080 --> 00:01:50.710
这就是制作探索性图表的目标

40
00:01:50.710 --> 00:01:53.160
通常你所关心的许多问题

41
00:01:53.160 --> 00:01:56.060
比如图表的外观

42
00:01:56.060 --> 00:01:59.575
或是展示形式 这些你现在都不需要关心

43
00:01:59.575 --> 00:02:00.810
坐标和图例这类东西

44
00:02:00.810 --> 00:02:04.160
之后通常都会被清理掉

45
00:02:04.160 --> 00:02:06.530
颜色和大小主要用于分离信息

46
00:02:06.530 --> 00:02:08.490
颜色和大小主要用于分离信息

47
00:02:08.490 --> 00:02:08.920
但是在不同的场景下

48
00:02:08.920 --> 00:02:12.270
但是在不同的场景下

49
00:02:12.270 --> 00:02:14.370
比如一个报告或是一个演讲中

50
00:02:14.370 --> 00:02:17.610
你也许会更加仔细地考虑颜色和大小

51
00:02:17.610 --> 00:02:22.090
在这节课中我想通过一个例子

52
00:02:22.090 --> 00:02:23.920
来谈论通过一个数据集

53
00:02:23.920 --> 00:02:26.770
可以制作出哪些不同类型的探索性图表

54
00:02:26.770 --> 00:02:29.380
这是一个关于美国环境空气污染的数据集

55
00:02:29.380 --> 00:02:32.650
这是一个关于美国环境空气污染的数据集

56
00:02:32.650 --> 00:02:35.270
它来自于美国国家环境保护局 (EPA)

57
00:02:35.270 --> 00:02:38.310
国家环境空气质量标准就是由此机构制定的

58
00:02:39.380 --> 00:02:40.970
我们要看的是其中一类特别的污染物

59
00:02:40.970 --> 00:02:43.650
就是微粒污染 (fine particle pollution) 也叫做 pm2.5

60
00:02:43.650 --> 00:02:47.780
美国的标准是 在一个给定的地点

61
00:02:47.780 --> 00:02:49.640
三年内的年平均每立方米

62
00:02:49.640 --> 00:02:52.470
不得超过12微克

63
00:02:52.470 --> 00:02:57.710
所以对于任何一个州 当你计算出它每年的年均值

64
00:02:57.710 --> 00:03:00.880
然后再把三年的年均值进行平均 结果每立方米大于12微克时

65
00:03:00.880 --> 00:03:03.980
就会认为它是不符合国家标准的

66
00:03:03.980 --> 00:03:11.400
你在 EPA 的空气质量系统中可以得到相关数据

67
00:03:11.400 --> 00:03:13.300
为了展示给你们看

68
00:03:13.300 --> 00:03:16.240
我已经下载并且在这里汇总好了

69
00:03:16.240 --> 00:03:18.670
在这个探索性分析中最基本的问题就是

70
00:03:18.670 --> 00:03:21.110
在这个探索性分析中最基本的问题就是

71
00:03:21.110 --> 00:03:22.970
在美国有没有任何县的微粒污染

72
00:03:22.970 --> 00:03:25.770
超出了国家标准？

73
00:03:25.770 --> 00:03:27.200
那么

74
00:03:27.200 --> 00:03:30.130
我们获取了美国存在空气污染问题的县的监测数据

75
00:03:30.130 --> 00:03:32.730
我们获取了美国存在空气污染问题的县的监测数据

76
00:03:32.730 --> 00:03:35.660
然后我们想要知道

77
00:03:35.660 --> 00:03:39.210
它们有没有超出每立方米12微克的标准 这是最近才制定出来的标准

78
00:03:42.250 --> 00:03:44.270
这里的数据都是可以得到的

79
00:03:44.270 --> 00:03:46.910
你可以用 read.csv() 读取这些数据

80
00:03:46.910 --> 00:03:48.920
我把代码放在这里 便于你们查看

81
00:03:48.920 --> 00:03:52.130
这里是这个数据框的前几行

82
00:03:52.130 --> 00:03:55.730
第一列是 pm2.5 水平

83
00:03:55.730 --> 00:03:59.460
它是过去三年年均值的平均

84
00:03:59.460 --> 00:04:01.990
它是过去三年年均值的平均

85
00:04:01.990 --> 00:04:03.620
实际上就是从2008年到2010年的数据

86
00:04:03.620 --> 00:04:08.350
然后这列叫做 fips 的是县编号

87
00:04:08.350 --> 00:04:09.300
然后这列叫做 fips 的是县编号

88
00:04:11.100 --> 00:04:14.090
然后 region 就是

89
00:04:14.090 --> 00:04:15.600
县位于东部还是在西部

90
00:04:16.630 --> 00:04:20.390
longitude 和 latitude

91
00:04:20.390 --> 00:04:24.280
是县里监测仪的位置

92
00:04:24.280 --> 00:04:27.320
就是县里监测仪的经度和纬度的坐标

93
00:04:27.320 --> 00:04:30.620
要记住一个基本的问题是

94
00:04:30.620 --> 00:04:33.260
我们想要知道有没有县超出了

95
00:04:33.260 --> 00:04:35.930
每立方米12微克的国家标准

96
00:04:35.930 --> 00:04:38.630
即使在探索性分析中你只是浏览一下数据 查看有没有什么问题

97
00:04:38.630 --> 00:04:41.902
即使在探索性分析中你只是浏览一下数据 查看有没有什么问题

98
00:04:41.902 --> 00:04:43.890
你心里也要抱有一些基本的疑问

99
00:04:43.890 --> 00:04:46.790
你心里也要抱有一些基本的疑问

100
00:04:46.790 --> 00:04:48.280
即使现在它只是一个有些模糊的问题

101
00:04:48.280 --> 00:04:50.270
即使现在它只是一个有些模糊的问题

102
00:04:50.270 --> 00:04:55.060
因为你所问的问题会左右你对数据的看法

103
00:04:55.060 --> 00:04:58.542
并且有些事情可能对于一类疑问来说是问题

104
00:04:58.542 --> 00:05:00.960
而对另一类疑问来说就不是问题

105
00:05:00.960 --> 00:05:02.710
所以当你在浏览数据的时候

106
00:05:02.710 --> 00:05:05.240
你心里要有一个背景问题

107
00:05:05.240 --> 00:05:10.250
我们想要知道的就是有没有县超出了国家环境空气质量标准

108
00:05:10.250 --> 00:05:12.640
我们可以看看数据的一维汇总

109
00:05:12.640 --> 00:05:14.970
这是我列出来的一些汇总

110
00:05:14.970 --> 00:05:16.400
一个是五数概括

111
00:05:16.400 --> 00:05:20.150
还有箱线图 直方图 核密度图和条形图

112
00:05:20.150 --> 00:05:23.820
我会做一些简单的说明

113
00:05:23.820 --> 00:05:27.590
第一个是五数概括 很明显它不是图

114
00:05:27.590 --> 00:05:29.420
但它会对给定变量在特定方面做汇总

115
00:05:29.420 --> 00:05:33.020
但它会对给定变量在特定方面做汇总

116
00:05:33.020 --> 00:05:36.470
在 R 中 summary() 可以产生这个汇总

117
00:05:36.470 --> 00:05:39.780
实际上这是六数概括 因为它包括了平均数

118
00:05:39.780 --> 00:05:41.380
传统的五数概括只包括了

119
00:05:41.380 --> 00:05:43.810
最小值、第一四分位数、中位数、第三四分位数

120
00:05:43.810 --> 00:05:47.990
还有最大值 而 summary() 会把平均值也放进来

121
00:05:47.990 --> 00:05:49.500
你可以看到

122
00:05:49.500 --> 00:05:53.590
中位数是每立方米10微克 在标准以内

123
00:05:53.590 --> 00:05:55.950
最大值是18.4 超出了标准

124
00:05:55.950 --> 00:05:58.344
所以一定有一些县没有符合标准

125
00:05:58.344 --> 00:06:01.480
至少在这段时间是这样

126
00:06:01.480 --> 00:06:04.530
你也可以看到第三四分位数是11

127
00:06:04.530 --> 00:06:08.520
第一四分位数是8.5 最小值是3.38

128
00:06:09.650 --> 00:06:12.530
这是对代表 pm2.5 浓度的那个变量做的箱线图

129
00:06:12.530 --> 00:06:14.600
我将它的颜色设为蓝色

130
00:06:14.600 --> 00:06:15.970
你可以看到中位数大概是10

131
00:06:15.970 --> 00:06:18.700
跟我们在五数概括中看到的一样

132
00:06:18.700 --> 00:06:21.110
你也可以看到有一些县

133
00:06:21.110 --> 00:06:23.728
超过了每立方米12微克的上限

134
00:06:23.728 --> 00:06:27.300
还有很多的县没有超过这个上限

135
00:06:27.300 --> 00:06:28.580
所以它们是符合标准的

136
00:06:30.120 --> 00:06:32.360
这是同一个数据的直方图

137
00:06:32.360 --> 00:06:34.360
使用直方图的一个好处就是

138
00:06:34.360 --> 00:06:39.230
你可以得到更多的一些细节 像是变量的分布

139
00:06:39.230 --> 00:06:39.770
我比较喜欢做的一件事是

140
00:06:39.770 --> 00:06:42.660
在直方图下面添加一个地毯图

141
00:06:42.660 --> 00:06:45.420
rug() 会在直方图下面

142
00:06:45.420 --> 00:06:49.040
画出数据集中的所有点

143
00:06:49.040 --> 00:06:52.720
这样你就可以知道构成直方图的点到底都在哪里

144
00:06:52.720 --> 00:06:54.930
所以一方面你用直方图给出了一个汇总

145
00:06:54.930 --> 00:06:58.680
另一方面你还在下面用地毯图给出了一些细节

146
00:06:58.680 --> 00:07:00.340
这样你就可以知道异常值在哪

147
00:07:00.340 --> 00:07:02.660
还有大部分数据分布在哪里

148
00:07:02.660 --> 00:07:04.960
你可以看到数据大概集中在10左右

149
00:07:04.960 --> 00:07:07.190
你可以看到数据大概集中在10左右

150
00:07:07.190 --> 00:07:10.700
但是也有一些异常值超过了15

151
00:07:12.100 --> 00:07:14.380
在直方图中你可以改变参数 breaks

152
00:07:14.380 --> 00:07:18.930
它决定了直方图由多少条组成

153
00:07:18.930 --> 00:07:21.340
你可以看到 在之前的幻灯片中

154
00:07:21.340 --> 00:07:24.540
条相对更宽一点 所以直方图就会更平滑

155
00:07:24.540 --> 00:07:25.890
但在这张幻灯片中

156
00:07:25.890 --> 00:07:29.100
我把 breaks 设成100 于是条变得更窄了

157
00:07:29.100 --> 00:07:29.960
你会发现

158
00:07:29.960 --> 00:07:33.190
你得到了一个更加不平滑的直方图

159
00:07:33.190 --> 00:07:34.520
在你设置参数 breaks 的时候

160
00:07:34.520 --> 00:07:37.060
你需要关心的一件事就是

161
00:07:37.060 --> 00:07:39.080
你不希望这个数字过大

162
00:07:39.080 --> 00:07:42.720
因为这样你就会得到很多很细的条 直方图会变得非常混乱

163
00:07:42.720 --> 00:07:44.610
当然你也不希望这个数字太小

164
00:07:44.610 --> 00:07:47.790
因为这样你得到的条就太少了以至于你无法看出分布的形状

165
00:07:47.790 --> 00:07:50.170
所以通常情况下

166
00:07:50.170 --> 00:07:52.050
尝试设置不同的 breaks 参数是非常有用的

167
00:07:52.050 --> 00:07:53.620
目的是找出合适的直方图条数

168
00:07:53.620 --> 00:07:55.750
这样你就可以得到最想要的直方图

169
00:07:58.120 --> 00:08:01.330
这是我之前给你们展示过的箱线图

170
00:08:01.330 --> 00:08:05.778
但是我现在还要在这张图上再加一个特征 就是在12这个位置的水平线

171
00:08:05.778 --> 00:08:07.770
因为国家环境空气质量标准是12

172
00:08:07.770 --> 00:08:10.830
所以我就在12这个地方加上这条线

173
00:08:10.830 --> 00:08:12.200
这样你就可以多少有些感觉

174
00:08:12.200 --> 00:08:15.630
多少个县在这条线以上 多少个县在这条线以下

175
00:08:15.630 --> 00:08:18.048
你可以看到大部分县 超过75%

176
00:08:18.048 --> 00:08:23.400
都在这条线以下 因为整个蓝箱都在这条线以下

177
00:08:23.400 --> 00:08:24.120
都在这条线以下 因为整个蓝箱都在这条线以下

178
00:08:24.120 --> 00:08:28.730
箱子的上缘是第75个百分位数 或称第三四分位数

179
00:08:28.730 --> 00:08:32.460
这对于找出特定的特征是非常有用的

180
00:08:32.460 --> 00:08:34.340
你们在直方图中也可以这么做

181
00:08:34.340 --> 00:08:38.476
我在12这里画了一条垂直的线 就是这条黑色的线

182
00:08:38.476 --> 00:08:40.620
然后我又在中位数这里

183
00:08:40.620 --> 00:08:43.120
画了一条洋红色的垂直线

184
00:08:43.120 --> 00:08:45.740
这样你就可以看到数据分布的中位数到底在哪里

185
00:08:45.740 --> 00:08:48.550
在箱线图中这是显而易见的

186
00:08:48.550 --> 00:08:49.645
因为箱线图的一个特征就是中位数

187
00:08:49.645 --> 00:08:52.100
但是在直方图中不是这样的

188
00:08:52.100 --> 00:08:54.530
所以有些时候最好画一条垂直的线突出中位数

189
00:08:54.530 --> 00:08:57.380
这次你们还可以看到中位数在标准之下

190
00:08:57.380 --> 00:09:00.920
但也有很多县在标准之上

191
00:09:03.330 --> 00:09:07.650
条形图是对分类数据的另外一种图表化汇总方式

192
00:09:07.650 --> 00:09:10.860
这里我对 region 变量进行操作

193
00:09:10.860 --> 00:09:13.890
你可以看到有多少县在东部 而有多少县在西部

194
00:09:13.890 --> 00:09:15.240
你可以看到

195
00:09:15.240 --> 00:09:17.980
美国的大部分县都在东部

196
00:09:17.980 --> 00:09:20.280
另外有略微超过100个县在美国的西部

197
00:09:20.280 --> 00:09:22.870
另外有略微超过100个县在美国的西部

198
00:09:22.870 --> 00:09:25.920
所以条形图汇总的就是这种分类变量
【教育无边界字幕组】迈迈的手套 | 养不肥的猪 | LennyBear

199
00:09:25.920 --> 00:09:27.980
所以条形图汇总的就是这种分类变量
【教育无边界字幕组】迈迈的手套 | 养不肥的猪 | LennyBear