WEBVTT

1
00:00:00.510 --> 00:00:01.690
接下来我们来分别看看

2
00:00:01.690 --> 00:00:05.340
对矩阵进行奇异值分解之后

3
00:00:05.340 --> 00:00:07.960
我们所得到的矩阵 U 中的左奇异值

4
00:00:07.960 --> 00:00:11.000
以及矩阵 V 中的右奇异值

5
00:00:11.000 --> 00:00:13.760
你现在所看到的左边的这张图

6
00:00:13.760 --> 00:00:17.790
表示的就是我们之前用到的原始数据矩阵

7
00:00:19.560 --> 00:00:25.760
而中间的图所画的

8
00:00:25.760 --> 00:00:29.170
则是我们得到的第一个左奇异向量

9
00:00:29.170 --> 00:00:36.370
这张图能够粗略地表示出这个数据集的一些均值

10
00:00:36.370 --> 00:00:40.510
如果我们按照行的顺序画出第一个左奇异向量的值的话

11
00:00:40.510 --> 00:00:45.430
从图中我们可以看出

12
00:00:45.430 --> 00:00:51.538
从第40行到第18还是第17行 它的值都是负的

13
00:00:51.538 --> 00:00:53.770
而其余的行中 我们得到的值则是正数

14
00:00:53.770 --> 00:01:01.220
因此 这些值清晰地表达出了 我们的模式中两种行均值的区别

15
00:01:01.220 --> 00:01:04.410
然后 我们再来看看

16
00:01:04.410 --> 00:01:08.140
我们得到的第一个右奇异向量

17
00:01:08.140 --> 00:01:11.760
这些值同样也表达出了

18
00:01:11.760 --> 00:01:16.000
前5列和后5列之间均值的差别

19
00:01:16.000 --> 00:01:16.700
所以 奇异值分解的一个优点就是

20
00:01:16.700 --> 00:01:19.360
所以 奇异值分解的一个优点就是

21
00:01:19.360 --> 00:01:22.405
通过它 我们可以很容易地观察到

22
00:01:22.405 --> 00:01:24.040
矩阵均值的偏移模式

23
00:01:24.040 --> 00:01:26.510
无论是行均值 还是列均值 它都能表示出来

24
00:01:27.550 --> 00:01:29.100
而且不需要其它附加信息

25
00:01:29.100 --> 00:01:32.490
这个方法也是无监督的 并且能自动捕捉到这些模式

26
00:01:32.490 --> 00:01:36.740
之前我们也画过非常类似的图

27
00:01:36.740 --> 00:01:39.950
但那是在得知矩阵的模式之后才能画出来的

28
00:01:39.950 --> 00:01:42.040
但这里 利用奇异值分解的方法

29
00:01:42.040 --> 00:01:43.900
我们立刻就能得知矩阵的模式

30
00:01:43.900 --> 00:01:46.090
只需要观察

31
00:01:46.090 --> 00:01:48.620
第一个左奇异值和右奇异值就可以了

32
00:01:51.400 --> 00:01:53.600
奇异值分解所产生的另一个成分

33
00:01:53.600 --> 00:01:56.290
我们称之为方差解释值

34
00:01:56.290 --> 00:01:59.300
也就是我们得到的矩阵 D 中的奇异值

35
00:01:59.300 --> 00:02:02.160
矩阵 D 事实上是一个对角矩阵

36
00:02:02.160 --> 00:02:05.680
主对角线之外的元素皆为0

37
00:02:05.680 --> 00:02:09.800
我们可以把它的每一个奇异值

38
00:02:09.800 --> 00:02:11.390
看作是某个特定成分所解释的数据变化

39
00:02:11.390 --> 00:02:16.340
在数据总方差中所占的百分比

40
00:02:16.340 --> 00:02:19.730
因此 所有成分也会根据方差解释值从大到小的顺序被排序

41
00:02:19.730 --> 00:02:22.180
第一个成分所能解释的数据变化最多

42
00:02:22.180 --> 00:02:24.600
第二个次之 以此类推

43
00:02:24.600 --> 00:02:27.180
所以 你可以画出所有成分解释方差值的百分比

44
00:02:27.180 --> 00:02:32.650
就如我们在下面这个图中所看到的

45
00:02:32.650 --> 00:02:36.410
左侧这张图中 我直接画出了所有奇异值的原始值

46
00:02:36.410 --> 00:02:40.510
不难看出 这些值依照列的顺序递减

47
00:02:40.510 --> 00:02:41.650
当然 原始的奇异值

48
00:02:41.650 --> 00:02:46.100
并不在可解释的尺度上 因此光看这些数并没有太多的意义

49
00:02:46.100 --> 00:02:48.330
但如果我将它们分别除以

50
00:02:48.330 --> 00:02:50.890
所有奇异值的总和 

51
00:02:50.890 --> 00:02:52.720
我们得到的值如右图所示 

52
00:02:52.720 --> 00:02:55.180
这些值可以用来表示它们所解释的方差的比例

53
00:02:55.180 --> 00:02:57.350
我们得到了和左边几乎一样的图 只有y轴有些变化

54
00:02:57.350 --> 00:02:59.600
从图中我们可以看出 第一个奇异值

55
00:02:59.600 --> 00:03:02.330
已经表达出了行和列的均值

56
00:03:02.330 --> 00:03:06.220
都有一定的偏移

57
00:03:06.220 --> 00:03:06.600
它大约捕捉到了数据中40%的变化

58
00:03:06.600 --> 00:03:10.580
它大约捕捉到了数据中40%的变化

59
00:03:10.580 --> 00:03:13.850
几乎有将近一半的方差

60
00:03:13.850 --> 00:03:16.970
都可以被这一个奇异值解释

61
00:03:16.970 --> 00:03:19.210
你也可以把它看做是数据的一个维度

62
00:03:19.210 --> 00:03:22.760
而其余的变化则可以通过数据中的其它成分来解释

63
00:03:25.790 --> 00:03:27.700
从这里我们也可以看到

64
00:03:27.700 --> 00:03:31.230
奇异值分析和主成分分析的关系是非常接近的

65
00:03:31.230 --> 00:03:33.900
现在 我对同一个矩阵

66
00:03:33.900 --> 00:03:37.850
进行了 SVD (奇异值分解) 和 PCA (主成分分析)

67
00:03:37.850 --> 00:03:41.460
在这张图中 x 轴表示的

68
00:03:41.460 --> 00:03:45.060
是我们得到的第一个主成分的值

69
00:03:45.060 --> 00:03:48.020
而 y 值则是我们得到的第一个右奇异向量

70
00:03:48.020 --> 00:03:51.120
我们看到二者形成了一条直线

71
00:03:51.120 --> 00:03:52.800
它们二者是完全相等的

72
00:03:52.800 --> 00:03:54.810
所以 SVD 和主成分分析

73
00:03:54.810 --> 00:03:57.430
基本上可以说是同一个东西

74
00:03:57.430 --> 00:04:00.850
如果哪天你在一个鸡尾酒会上 听到两个人

75
00:04:00.850 --> 00:04:03.870
在谈论 SVD 和 PCA 的话题

76
00:04:03.870 --> 00:04:05.990
你可以确信 他们基本上是在讲同一个东西

77
00:04:10.460 --> 00:04:14.580
现在 我们来更具体地看看方差解释值

78
00:04:14.580 --> 00:04:17.390
这里有一个非常简单的例子

79
00:04:18.780 --> 00:04:23.830
现在这个矩阵里的值 只有0和1两种

80
00:04:23.830 --> 00:04:25.440
所以 这个矩阵里只有一种模式 对吧

81
00:04:25.440 --> 00:04:28.040
所以 这个矩阵里只有一种模式 对吧

82
00:04:28.040 --> 00:04:30.510
前5列的值都为0

83
00:04:30.510 --> 00:04:35.970
后5列的值则都是1 就是这么简单的一个矩阵

84
00:04:35.970 --> 00:04:38.810
如果我们画出这个矩阵的话 可以看到

85
00:04:38.810 --> 00:04:43.109
左侧 也就是前5列是红色 而后5列则是浅黄色

86
00:04:44.200 --> 00:04:46.030
现在对这个简单的矩阵做 SVD

87
00:04:46.030 --> 00:04:49.870
然后画出它的奇异值

88
00:04:49.870 --> 00:04:52.260
可以看到 只有一个奇异值

89
00:04:52.260 --> 00:04:55.190
在特别高的位置 其余的则基本接近于0

90
00:04:55.190 --> 00:04:57.020
不难发现 第一个奇异值

91
00:04:57.020 --> 00:05:01.760
解释了这个数据集100%的方差

92
00:05:01.760 --> 00:05:02.440
为什么会这样呢？

93
00:05:02.440 --> 00:05:05.390
想想我们这个数据集

94
00:05:05.390 --> 00:05:10.240
虽然有40行10列 但其实只有一维而已

95
00:05:10.240 --> 00:05:13.240
也就是说 前5列任一列的均值都是0

96
00:05:13.240 --> 00:05:16.520
而后5列任一列的均值都是1

97
00:05:16.520 --> 00:05:20.210
因此 就算矩阵中有这么多次观测

98
00:05:20.210 --> 00:05:25.440
每个观测所贡献的信息量却是非常小的

99
00:05:25.440 --> 00:05:27.740
而我们的 SVD 结果也正捕捉到了这一情况

100
00:05:27.740 --> 00:05:29.070
也就是我们数据中的第一个成分

101
00:05:29.070 --> 00:05:33.160
独自就可以解释100%的方差

102
00:05:34.770 --> 00:05:37.380
现在 让我们在数据中再多加一种模式

103
00:05:37.380 --> 00:05:40.780
我们可以在数据中按行设置一种模式

104
00:05:40.780 --> 00:05:44.050
再按列设置另一种模式

105
00:05:44.050 --> 00:05:46.020
第一种模式的话

106
00:05:46.020 --> 00:05:47.990
就用我们刚才用过的分块模式好了

107
00:05:47.990 --> 00:05:50.220
我们让这个矩阵的一半拥有同样的均值

108
00:05:50.220 --> 00:05:51.960
另一半拥有另一个均值

109
00:05:51.960 --> 00:05:52.840
第二种模式的话

110
00:05:52.840 --> 00:05:56.050
我们则按列设置一种交替模式

111
00:05:56.050 --> 00:05:58.130
就像图中你看到的这样

112
00:05:58.130 --> 00:06:02.270
左侧的这张图就是我们的数据 我们可以看出

113
00:06:02.270 --> 00:06:05.000
第一种模式 也就是我们的分块模式

114
00:06:05.000 --> 00:06:09.180
前5列的值较小 而后5列的值较大

115
00:06:09.180 --> 00:06:11.420
而第二种模式 可以说是嵌在第一种模式当中的

116
00:06:11.420 --> 00:06:14.800
是每隔一列都有的一种规律

117
00:06:14.800 --> 00:06:18.530
这些列的值 是按照一列较大 一列较小 这样交替排列的

118
00:06:18.530 --> 00:06:21.030
所以 事实上 如果我们绘制出这些信息

119
00:06:21.030 --> 00:06:23.480
所以 事实上 如果我们绘制出这些信息

120
00:06:23.480 --> 00:06:27.560
我们可以看到中间这张图 

121
00:06:27.560 --> 00:06:30.730
前5列的均值较低 后5列的均值则比较高

122
00:06:31.890 --> 00:06:37.200
这就是我们的第一个模式 而第二种模式中

123
00:06:37.200 --> 00:06:42.790
第1列的均值为0 第二列均值为1

124
00:06:42.790 --> 00:06:43.622
第3列均值为0 第4列为1 以此类推

125
00:06:43.622 --> 00:06:45.580
第3列均值为0 第4列为1 以此类推

126
00:06:45.580 --> 00:06:47.820
所以 这里我们有两种模式

127
00:06:47.820 --> 00:06:49.960
一种是偏移模式

128
00:06:49.960 --> 00:06:53.170
另一种是类似交替的模式 这就是真实情况

129
00:06:53.170 --> 00:06:55.640
当然 真实情况通常对我们来说是未知的

130
00:06:55.640 --> 00:06:57.430
我们需要从数据中分析出它们

131
00:06:57.430 --> 00:06:59.380
所以 如果你得到了一个

132
00:06:59.380 --> 00:07:01.380
左图所示的这样的数据集

133
00:07:02.770 --> 00:07:05.370
你能不能想到一种算法

134
00:07:05.370 --> 00:07:08.330
来发掘出这些数据中隐藏的两种不同的模式呢？

135
00:07:08.330 --> 00:07:08.700
那 SVD 就是我们所需要的算法了

136
00:07:08.700 --> 00:07:09.900
那 SVD 就是我们所需要的算法了

137
00:07:11.000 --> 00:07:15.390
如果我们对这个拥有两种模式的新矩阵做 SVD 的话

138
00:07:15.390 --> 00:07:17.610
最左侧的图依然是我们的数据

139
00:07:17.610 --> 00:07:22.730
中间的图 则是我们得到的第一个右奇异向量

140
00:07:22.730 --> 00:07:25.250
可以看出 它粗略地表达出了我们的分块模式

141
00:07:25.250 --> 00:07:25.510
是吧？

142
00:07:25.510 --> 00:07:27.970
也就是 前5列相对较小

143
00:07:27.970 --> 00:07:31.180
而后5列相对较大

144
00:07:31.180 --> 00:07:33.880
对吧？ 当然 它并不像真实情况那样看上去这么清晰

145
00:07:33.880 --> 00:07:38.870
但我们还是能分辨出 这其中有两种不同的均值

146
00:07:38.870 --> 00:07:42.020
而第二个右奇异向量

147
00:07:42.020 --> 00:07:44.950
被画在了右侧的图中

148
00:07:44.950 --> 00:07:47.270
这张图的规律不是那么容易能看出来

149
00:07:47.270 --> 00:07:50.540
但它还是能表现出均值的交替模式 对吧？

150
00:07:50.540 --> 00:07:54.400
当然 跟真实情况所得的图相比 这张图的模式确实不太明显

151
00:07:54.400 --> 00:07:58.600
但我们可以看出 这些点都是高低交替着出现的

152
00:07:58.600 --> 00:08:02.110
当然 因为我们已经知道了真实情况

153
00:08:02.110 --> 00:08:03.960
做出这样的推断就相对容易一些

154
00:08:05.060 --> 00:08:09.530
但同时拥有两种模式的话 结果通常都会让人有些疑惑的

155
00:08:09.530 --> 00:08:12.950
我们很难把两种模式完全分开

156
00:08:12.950 --> 00:08:15.190
即便在真实情况中

157
00:08:15.190 --> 00:08:17.490
两种模式的区别非常明显

158
00:08:17.490 --> 00:08:20.240
我们所得的第一个和第二个奇异向量

159
00:08:20.240 --> 00:08:22.420
又被称为主成分

160
00:08:23.610 --> 00:08:25.450
它们会把两种模式混在一起

161
00:08:25.450 --> 00:08:27.690
所以 它们二者都有一定的分块模式

162
00:08:27.690 --> 00:08:30.560
也都有一些交替模式

163
00:08:30.560 --> 00:08:35.330
但让人遗憾的是 就像大多实际中的数据一样

164
00:08:35.330 --> 00:08:38.130
如果我们不知道真实情况的话 这些模式都不是那么容易能判断出来的

165
00:08:40.240 --> 00:08:42.400
现在我们来看看这个问题的方差解释值

166
00:08:42.400 --> 00:08:45.740
我们看右侧的图 它表示的是

167
00:08:45.740 --> 00:08:50.815
各变量解释方差的百分比 

168
00:08:50.815 --> 00:08:54.870
第1个成分的方差解释量 超过数据集总方差的50%

169
00:08:54.870 --> 00:08:57.580
基本上这要归结于我们的偏移模式

170
00:08:57.580 --> 00:09:00.600
前5列和后5列的区别非常明显

171
00:09:00.600 --> 00:09:03.830
所以在数据集的总方差中 占有非常大的比重

172
00:09:03.830 --> 00:09:05.340
所以 只要找到了偏移模式

173
00:09:05.340 --> 00:09:08.070
你就发现了数据集变化模式中的很大一部分

174
00:09:08.070 --> 00:09:10.790
而我们的第二个成分 只捕捉到了大约18%的数据变化

175
00:09:10.790 --> 00:09:14.380
而之后的成分就更不值一提了

176
00:09:14.380 --> 00:09:17.240
所以 从这个结果中 你可以粗略地了解到

177
00:09:17.240 --> 00:09:19.990
这个数据集中到底有多少个不同的成分

178
00:09:19.990 --> 00:09:22.780
但是 每隔一行的那个交替模式

179
00:09:22.780 --> 00:09:25.030
如你所见 是相对难以捕捉的
【教育无边界字幕组】ChelseaT | hazard1990 | HikaruSama